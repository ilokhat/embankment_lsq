import logging
from shapely.wkt import loads
from shapes_and_geoms_stuff import get_points_talus
from triangulation import get_edges_from_triangulation
from displacer import LSDisplacer, loglsd

roads = ['LineString(918930.79999999701976776 6324494.69999999925494194 574.10000000000582077, 918924.60000000149011612 6324497.5 574.39999999999417923, 918921.39999999850988388 6324499.10000000149011612 574.89999999999417923, 918917.10000000149011612 6324501.80000000074505806 575.69999999999708962, 918912.70000000298023224 6324505.10000000149011612 576.10000000000582077, 918893.29999999701976776 6324523.30000000074505806 579.80000000000291038, 918888.70000000298023224 6324526.89999999850988388 580.89999999999417923, 918880.20000000298023224 6324533.69999999925494194 582.89999999999417923, 918868.79999999701976776 6324543.5 584.89999999999417923, 918864.89999999850988388 6324545.69999999925494194 586.10000000000582077, 918861.39999999850988388 6324546.89999999850988388 586.60000000000582077, 918855.60000000149011612 6324548.39999999850988388 587.30000000000291038, 918850.89999999850988388 6324549.39999999850988388 588.19999999999708962, 918846 6324550.19999999925494194 588.5, 918839.20000000298023224 6324550.80000000074505806 589.69999999999708962, 918829.39999999850988388 6324551.80000000074505806 591.19999999999708962, 918821.79999999701976776 6324552.89999999850988388 592.60000000000582077, 918810.20000000298023224 6324556.30000000074505806 594.39999999999417923, 918803.70000000298023224 6324559.10000000149011612 595.5, 918793.5 6324562.60000000149011612 596.30000000000291038, 918773.5 6324570 598.19999999999708962, 918764.79999999701976776 6324573.19999999925494194 598.89999999999417923, 918754.60000000149011612 6324577 599.89999999999417923, 918745.70000000298023224 6324579.10000000149011612 600.39999999999417923, 918731.20000000298023224 6324582.30000000074505806 601.30000000000291038, 918716.70000000298023224 6324585.39999999850988388 601.60000000000582077, 918705.70000000298023224 6324588.10000000149011612 602.89999999999417923, 918697.70000000298023224 6324589.19999999925494194 603.60000000000582077, 918689.70000000298023224 6324589.30000000074505806 604.39999999999417923, 918683.39999999850988388 6324589.19999999925494194 605.10000000000582077, 918677.89999999850988388 6324588.30000000074505806 605.89999999999417923, 918668.29999999701976776 6324585.30000000074505806 607, 918660.5 6324581 607.19999999999708962, 918649.29999999701976776 6324574.19999999925494194 606.80000000000291038)',
        'LineString(918930.79999999701976776 6324494.69999999925494194 574.10000000000582077, 918933.79999999701976776 6324498.5 573.5, 918938.29999999701976776 6324501.39999999850988388 573.19999999999708962, 918941.70000000298023224 6324502.80000000074505806 573)',
        'LineString(918941.70000000298023224 6324502.80000000074505806 573, 918943.89999999850988388 6324503.60000000149011612 572.5, 918952.39999999850988388 6324505.80000000074505806 571.39999999999417923, 918963.5 6324506.89999999850988388 570.60000000000582077)',
        'LineString(918908.5 6324559.19999999925494194 574.89999999999417923, 918911.70000000298023224 6324549.30000000074505806 574.60000000000582077, 918921.89999999850988388 6324529.89999999850988388 573.80000000000291038, 918935 6324510.69999999925494194 572.89999999999417923, 918941.70000000298023224 6324502.80000000074505806 573)',
        'LineString(918887.20000000298023224 6324674.89999999850988388 573.69999999999708962, 918894.70000000298023224 6324670.19999999925494194 573.69999999999708962, 918900.60000000149011612 6324667.19999999925494194 573.60000000000582077, 918905 6324664.30000000074505806 572.89999999999417923, 918909.10000000149011612 6324659.5 572.60000000000582077, 918911.60000000149011612 6324654.89999999850988388 572.60000000000582077, 918913.10000000149011612 6324649.30000000074505806 572.39999999999417923, 918913.79999999701976776 6324644.19999999925494194 572.39999999999417923, 918913.89999999850988388 6324638.80000000074505806 572.10000000000582077, 918913.60000000149011612 6324617.89999999850988388 571.10000000000582077, 918913.79999999701976776 6324610.39999999850988388 570.89999999999417923, 918914.29999999701976776 6324604.39999999850988388 570.39999999999417923, 918915.29999999701976776 6324597.5 570.30000000000291038, 918917.20000000298023224 6324586.89999999850988388 570.10000000000582077, 918919.70000000298023224 6324572.80000000074505806 569.60000000000582077, 918923.39999999850988388 6324556.89999999850988388 569.39999999999417923, 918925.5 6324550.80000000074505806 569.5, 918928.5 6324544.69999999925494194 569.69999999999708962, 918935.60000000149011612 6324534.39999999850988388 570.10000000000582077, 918943.20000000298023224 6324524.19999999925494194 570.60000000000582077, 918948.10000000149011612 6324519.30000000074505806 570.69999999999708962, 918953.70000000298023224 6324514.5 570.69999999999708962, 918958 6324511.10000000149011612 570.30000000000291038, 918963.5 6324506.89999999850988388 570.60000000000582077)']
talus = ['LineString(918868.29999999701976776 6324566.30000000074505806 580.89999999999417923, 918851.39999999850988388 6324593.19999999925494194 580.80000000000291038, 918851.70000000298023224 6324599.80000000074505806 580.10000000000582077, 918858.29999999701976776 6324607.80000000074505806 579.19999999999708962, 918859.29999999701976776 6324614.60000000149011612 579.19999999999708962, 918856.10000000149011612 6324625.89999999850988388 580, 918850.29999999701976776 6324637.5 580.80000000000291038, 918848.5 6324649.89999999850988388 580.60000000000582077, 918859.79999999701976776 6324656.39999999850988388 579.80000000000291038, 918861.39999999850988388 6324660.39999999850988388 579.39999999999417923, 918855.70000000298023224 6324664.60000000149011612 579.5, 918841.10000000149011612 6324664 581, 918829.70000000298023224 6324660.19999999925494194 581.60000000000582077)',
        'LineString(918944.10000000149011612 6324516.5 572.60000000000582077, 918932.29999999701976776 6324529.19999999925494194 573.39999999999417923, 918925.79999999701976776 6324540.60000000149011612 573.60000000000582077, 918918.70000000298023224 6324552.5 573.89999999999417923, 918915.10000000149011612 6324566.80000000074505806 574.30000000000291038, 918912.10000000149011612 6324586.89999999850988388 574.19999999999708962, 918908.70000000298023224 6324604.39999999850988388 574.60000000000582077, 918907.79999999701976776 6324623 574.60000000000582077, 918908.89999999850988388 6324638.69999999925494194 574.5, 918907.20000000298023224 6324650.10000000149011612 574.69999999999708962, 918902.60000000149011612 6324659.30000000074505806 574.69999999999708962, 918888.39999999850988388 6324668.69999999925494194 574.89999999999417923)',
        'LineString(918602.20000000298023224 6324637 614.89999999999417923, 918607.79999999701976776 6324640.69999999925494194 614.80000000000291038, 918611.20000000298023224 6324645.89999999850988388 614.80000000000291038, 918613.70000000298023224 6324653.30000000074505806 614.80000000000291038, 918614.70000000298023224 6324666.30000000074505806 614.39999999999417923, 918613 6324681.80000000074505806 614.30000000000291038, 918610.20000000298023224 6324699.10000000149011612 615.5, 918609.20000000298023224 6324717.10000000149011612 616.89999999999417923, 918609.79999999701976776 6324736.5 618.19999999999708962, 918610.70000000298023224 6324755.39999999850988388 618.89999999999417923, 918611 6324772.39999999850988388 619.89999999999417923, 918612.20000000298023224 6324781.39999999850988388 620.10000000000582077, 918626 6324783.19999999925494194 619, 918628.20000000298023224 6324797.89999999850988388 619.39999999999417923, 918628.5 6324815.89999999850988388 619.69999999999708962, 918627.10000000149011612 6324838.19999999925494194 619, 918622.70000000298023224 6324861.39999999850988388 617.80000000000291038, 918618.60000000149011612 6324876.69999999925494194 616.5)',
        'LineString(918717.79999999701976776 6324784.89999999850988388 602, 918714.5 6324805.5 602.10000000000582077, 918711.89999999850988388 6324828.5 603.19999999999708962, 918711 6324845.5 603.5, 918710.70000000298023224 6324860.10000000149011612 603.30000000000291038, 918709.20000000298023224 6324871.30000000074505806 602.69999999999708962, 918703.29999999701976776 6324882.39999999850988388 602.10000000000582077, 918691.20000000298023224 6324900.89999999850988388 602.80000000000291038, 918684.79999999701976776 6324914 603.10000000000582077)',
        'LineString(918641.5 6324651.89999999850988388 610.10000000000582077, 918667.39999999850988388 6324660.19999999925494194 607.69999999999708962, 918670.39999999850988388 6324662.19999999925494194 607.69999999999708962, 918672.79999999701976776 6324670.39999999850988388 607.89999999999417923, 918676.29999999701976776 6324685.39999999850988388 607.5, 918710 6324690.89999999850988388 603.69999999999708962, 918713.79999999701976776 6324693.19999999925494194 603.69999999999708962, 918716 6324697 603.80000000000291038, 918719.29999999701976776 6324719.19999999925494194 603.80000000000291038, 918720.60000000149011612 6324763.30000000074505806 602, 918720.70000000298023224 6324777.30000000074505806 601.89999999999417923)']

#one line
# roads = ['LineString(912682.29999999701976776 6317126.39999999850988388 723.10000000000582077, 912704.89999999850988388 6317119.30000000074505806 725.39999999999417923, 912735.5 6317110.60000000149011612 727.5, 912745 6317108 728.30000000000291038, 912749.89999999850988388 6317107.5 728.5, 912754.20000000298023224 6317108 728.60000000000582077, 912759.89999999850988388 6317109.89999999850988388 729.19999999999708962, 912764.5 6317111.89999999850988388 729.60000000000582077, 912769.89999999850988388 6317115.39999999850988388 730.19999999999708962, 912776.5 6317122.60000000149011612 730.80000000000291038, 912789.39999999850988388 6317139.19999999925494194 731.30000000000291038, 912802.60000000149011612 6317157.69999999925494194 732.60000000000582077, 912807.20000000298023224 6317164 733.10000000000582077, 912815.5 6317175 733.69999999999708962, 912822.79999999701976776 6317180.39999999850988388 734.10000000000582077, 912829 6317183.60000000149011612 734.10000000000582077, 912834.89999999850988388 6317185.39999999850988388 735, 912841.79999999701976776 6317186.39999999850988388 735.5, 912850.29999999701976776 6317186.69999999925494194 736.10000000000582077, 912854.29999999701976776 6317186.39999999850988388 736.39999999999417923, 912862.89999999850988388 6317185.89999999850988388 736.89999999999417923, 912872.20000000298023224 6317183.89999999850988388 737.69999999999708962, 912883.89999999850988388 6317179.89999999850988388 737.69999999999708962, 912893.10000000149011612 6317177.19999999925494194 738.5, 912904.60000000149011612 6317175.39999999850988388 739.30000000000291038, 912922.70000000298023224 6317173.39999999850988388 740.10000000000582077, 912927.5 6317173 741, 912937.10000000149011612 6317172.89999999850988388 741.19999999999708962, 912950.10000000149011612 6317173.30000000074505806 741.89999999999417923, 912972.60000000149011612 6317174.19999999925494194 742.89999999999417923, 913003.70000000298023224 6317175.39999999850988388 744.5, 913034.10000000149011612 6317175 746.69999999999708962, 913042.39999999850988388 6317174.5 747.80000000000291038, 913048.39999999850988388 6317173.30000000074505806 748, 913054.29999999701976776 6317171.10000000149011612 748.30000000000291038, 913067.10000000149011612 6317164.60000000149011612 749.19999999999708962, 913087.10000000149011612 6317154.60000000149011612 751.30000000000291038)']
# talus = ['LineString(913082.89999999850988388 6317165.5 750, 913065.20000000298023224 6317175.10000000149011612 749.80000000000291038, 913055.5 6317181.30000000074505806 748.80000000000291038, 913050.10000000149011612 6317183.39999999850988388 747.60000000000582077, 913045 6317185.10000000149011612 746.69999999999708962, 913040.29999999701976776 6317185.60000000149011612 747, 913037 6317184.5 747.10000000000582077, 913031.5 6317182.10000000149011612 746, 913027.29999999701976776 6317181 746, 913021 6317180.69999999925494194 745.80000000000291038, 913016.89999999850988388 6317182.30000000074505806 745.89999999999417923, 913010.5 6317184.30000000074505806 745.30000000000291038, 913008.20000000298023224 6317187.80000000074505806 745.30000000000291038, 913004.60000000149011612 6317190.60000000149011612 744.80000000000291038, 912998.29999999701976776 6317192.19999999925494194 744.69999999999708962, 912992.5 6317191.89999999850988388 744.19999999999708962, 912984.10000000149011612 6317191.39999999850988388 743.39999999999417923, 912975.89999999850988388 6317190.39999999850988388 743.39999999999417923, 912968.20000000298023224 6317186.69999999925494194 742.69999999999708962, 912963.5 6317183.5 742.60000000000582077, 912957.60000000149011612 6317184 742, 912951.10000000149011612 6317185 741.89999999999417923, 912947.20000000298023224 6317183.89999999850988388 741.69999999999708962, 912942.70000000298023224 6317182.10000000149011612 741.5, 912938.39999999850988388 6317178.19999999925494194 740.80000000000291038, 912934.89999999850988388 6317175.89999999850988388 740.69999999999708962, 912929.39999999850988388 6317176.10000000149011612 740.89999999999417923, 912925.39999999850988388 6317179.30000000074505806 740.5, 912920.60000000149011612 6317181 740, 912916.89999999850988388 6317180.39999999850988388 739.19999999999708962, 912915.29999999701976776 6317184.69999999925494194 739.30000000000291038, 912900.29999999701976776 6317183.19999999925494194 738.5, 912893.89999999850988388 6317182.19999999925494194 738.5, 912888.79999999701976776 6317184.39999999850988388 738.5, 912883.5 6317188 738.5, 912870.89999999850988388 6317190.5 737.19999999999708962, 912855.79999999701976776 6317193 735.5)']

# circled
# roads = ['LineString(913349.29999999701976776 6317908.69999999925494194 636.39999999999417923, 913347.39999999850988388 6317911.89999999850988388 637, 913346.70000000298023224 6317916.10000000149011612 637.69999999999708962, 913347 6317920.30000000074505806 638, 913348.39999999850988388 6317923.60000000149011612 638.19999999999708962, 913351.89999999850988388 6317928.30000000074505806 638.30000000000291038, 913364.20000000298023224 6317945.89999999850988388 638.30000000000291038, 913366.29999999701976776 6317951.10000000149011612 638.69999999999708962, 913367.20000000298023224 6317956.69999999925494194 639, 913366.10000000149011612 6317963.80000000074505806 639.5, 913362.29999999701976776 6317971.10000000149011612 639.80000000000291038, 913355.5 6317978 640.69999999999708962, 913346 6317984 640.89999999999417923, 913344.5 6317985.39999999850988388 640.89999999999417923, 913344.10000000149011612 6317988.80000000074505806 640.89999999999417923, 913345.10000000149011612 6317992.30000000074505806 640.89999999999417923, 913346.89999999850988388 6317994.39999999850988388 640.89999999999417923, 913349.29999999701976776 6317994.60000000149011612 640.80000000000291038, 913367.79999999701976776 6317988.30000000074505806 636.89999999999417923, 913374.20000000298023224 6317988.80000000074505806 635)',
# 'LineString(913374.20000000298023224 6317988.80000000074505806 635, 913389.10000000149011612 6317977.60000000149011612 632.80000000000291038, 913399.20000000298023224 6317969.39999999850988388 632, 913403.29999999701976776 6317963.19999999925494194 631.30000000000291038, 913405.79999999701976776 6317957.80000000074505806 631, 913407.29999999701976776 6317955.39999999850988388 630.80000000000291038, 913409 6317954.80000000074505806 630.30000000000291038, 913411.10000000149011612 6317954.89999999850988388 630.10000000000582077)',
# 'LineString(913349.29999999701976776 6317908.69999999925494194 636.39999999999417923, 913361.5 6317908.80000000074505806 635.89999999999417923, 913370.29999999701976776 6317908.89999999850988388 635.5, 913376 6317909.39999999850988388 635.10000000000582077, 913381 6317911.39999999850988388 634.19999999999708962, 913384 6317914.30000000074505806 633.89999999999417923, 913386.79999999701976776 6317917.19999999925494194 633.80000000000291038, 913393.89999999850988388 6317925.60000000149011612 632.89999999999417923, 913400.29999999701976776 6317933.69999999925494194 631.89999999999417923, 913406.60000000149011612 6317941.60000000149011612 631.39999999999417923, 913410.5 6317951.5 630.5, 913411.10000000149011612 6317954.89999999850988388 630.10000000000582077)']
# talus = ['LineString(913369.5 6317913.69999999925494194 632.5, 913376.29999999701976776 6317917.10000000149011612 637, 913381.70000000298023224 6317922.60000000149011612 637, 913389.60000000149011612 6317933.10000000149011612 637, 913393.60000000149011612 6317939.19999999925494194 635.30000000000291038, 913395.79999999701976776 6317944.80000000074505806 635.60000000000582077, 913398.10000000149011612 6317951.10000000149011612 635.69999999999708962, 913399.39999999850988388 6317956.30000000074505806 636.30000000000291038, 913398.89999999850988388 6317961.69999999925494194 637.10000000000582077, 913394.5 6317965.89999999850988388 637.19999999999708962, 913388.89999999850988388 6317969.19999999925494194 638.5, 913379.5 6317972.89999999850988388 638.69999999999708962, 913370 6317978.39999999850988388 639.5, 913366 6317980.30000000074505806 640.10000000000582077, 913363.10000000149011612 6317981.80000000074505806 640.60000000000582077, 913355.5 6317985.19999999925494194 642, 913349.39999999850988388 6317988.19999999925494194 642.69999999999708962)']

# cas nominal 1
# roads = ['LineString(907989.60000000149011612 6318421.69999999925494194 509, 907992.5 6318423.19999999925494194 505.89999999999417923, 907995.70000000298023224 6318424.19999999925494194 503, 908000.70000000298023224 6318424.69999999925494194 502.39999999999417923, 908004.60000000149011612 6318424.19999999925494194 502.10000000000582077, 908011.60000000149011612 6318422.69999999925494194 501.39999999999417923, 908017.79999999701976776 6318421 501, 908022.60000000149011612 6318419.89999999850988388 499.89999999999417923, 908028 6318418.89999999850988388 499.30000000000291038, 908033 6318418.39999999850988388 499, 908036.89999999850988388 6318418.39999999850988388 498.89999999999417923, 908042.39999999850988388 6318418.69999999925494194 498.89999999999417923, 908047.10000000149011612 6318419.60000000149011612 499, 908051.79999999701976776 6318420.30000000074505806 498.80000000000291038, 908055.89999999850988388 6318420.19999999925494194 498.69999999999708962, 908059.20000000298023224 6318419.19999999925494194 498.39999999999417923, 908063.10000000149011612 6318417.10000000149011612 497.80000000000291038, 908067.20000000298023224 6318413.39999999850988388 497, 908073.89999999850988388 6318404.30000000074505806 495, 908077.60000000149011612 6318399.30000000074505806 495.19999999999708962, 908080.5 6318396.30000000074505806 495.5, 908084.70000000298023224 6318393.30000000074505806 494.39999999999417923, 908088.20000000298023224 6318392.39999999850988388 494.19999999999708962, 908091.89999999850988388 6318392.5 494.19999999999708962, 908095.20000000298023224 6318393.30000000074505806 494.10000000000582077, 908098 6318394.60000000149011612 494.10000000000582077, 908100.79999999701976776 6318397.10000000149011612 493.39999999999417923, 908102.39999999850988388 6318400.39999999850988388 492.80000000000291038, 908103 6318404 492.30000000000291038, 908102.70000000298023224 6318407.39999999850988388 491.89999999999417923, 908101.70000000298023224 6318410.19999999925494194 491.89999999999417923, 908099.39999999850988388 6318413.30000000074505806 491.89999999999417923, 908087.10000000149011612 6318425.39999999850988388 490, 908068.70000000298023224 6318442.80000000074505806 489.39999999999417923, 908065.5 6318445.89999999850988388 488.89999999999417923, 908060.89999999850988388 6318449.39999999850988388 488.30000000000291038, 908055 6318452.5 487.80000000000291038, 908043.39999999850988388 6318457.5 486.60000000000582077, 908039.70000000298023224 6318459.80000000074505806 485.69999999999708962, 908036.89999999850988388 6318462.60000000149011612 485, 908034.29999999701976776 6318466.5 484.5, 908032.70000000298023224 6318470.5 484.10000000000582077, 908031.60000000149011612 6318475 483.5, 908031 6318479 483, 908031.70000000298023224 6318482.89999999850988388 483.5, 908033.70000000298023224 6318485.69999999925494194 484.10000000000582077)',
# 'LineString(907980.20000000298023224 6318396.5 507.69999999999708962, 907981.60000000149011612 6318399 507.39999999999417923, 907982.29999999701976776 6318401 507.10000000000582077, 907982.79999999701976776 6318404.30000000074505806 506.80000000000291038, 907983.29999999701976776 6318408.5 506.10000000000582077, 907983.79999999701976776 6318412.19999999925494194 505.5, 907985.10000000149011612 6318416.10000000149011612 504.80000000000291038, 907987.29999999701976776 6318419.30000000074505806 507, 907989.60000000149011612 6318421.69999999925494194 509)',
# 'LineString(907980.20000000298023224 6318396.5 507.69999999999708962, 907983.10000000149011612 6318395 507.69999999999708962, 907986.29999999701976776 6318392.89999999850988388 507.69999999999708962, 907989.20000000298023224 6318391.60000000149011612 508, 907992.39999999850988388 6318390.60000000149011612 508.39999999999417923, 907996.79999999701976776 6318390.39999999850988388 509, 908007.89999999850988388 6318390.69999999925494194 511.10000000000582077, 908013.39999999850988388 6318390.69999999925494194 509.10000000000582077, 908028.29999999701976776 6318391.19999999925494194 511.30000000000291038, 908035.20000000298023224 6318391.10000000149011612 512, 908039.60000000149011612 6318390.5 512.5, 908043 6318389.69999999925494194 512.5, 908046 6318388.19999999925494194 512.5, 908048.79999999701976776 6318386.39999999850988388 512.69999999999708962, 908050.79999999701976776 6318384.39999999850988388 513, 908052.70000000298023224 6318381.89999999850988388 513.30000000000291038, 908054.20000000298023224 6318378.39999999850988388 513.80000000000291038, 908058.39999999850988388 6318365 514.30000000000291038, 908060.60000000149011612 6318358.89999999850988388 515.10000000000582077, 908063.29999999701976776 6318353.39999999850988388 516, 908065.39999999850988388 6318350 516.60000000000582077, 908067.70000000298023224 6318347.5 517.19999999999708962, 908071 6318345.19999999925494194 517.19999999999708962, 908074.89999999850988388 6318343.5 517.19999999999708962, 908079.79999999701976776 6318342 517.19999999999708962, 908085.39999999850988388 6318341.69999999925494194 517.19999999999708962, 908090.10000000149011612 6318341.69999999925494194 517.39999999999417923, 908095.5 6318342.30000000074505806 517.80000000000291038, 908100.5 6318343 517.89999999999417923, 908106.70000000298023224 6318344.69999999925494194 518.39999999999417923, 908112 6318346.5 519, 908118.70000000298023224 6318349.19999999925494194 519.89999999999417923, 908124.10000000149011612 6318351.80000000074505806 520.80000000000291038, 908129.60000000149011612 6318354.80000000074505806 521.39999999999417923, 908134.89999999850988388 6318358.10000000149011612 522, 908140 6318362.39999999850988388 522.5, 908145.60000000149011612 6318368.39999999850988388 523.39999999999417923, 908156.39999999850988388 6318381.60000000149011612 524.69999999999708962, 908159.39999999850988388 6318384.60000000149011612 525.10000000000582077)']
# talus = ['LineString(908104.70000000298023224 6318388.39999999850988388 507.5, 908099.79999999701976776 6318379.89999999850988388 509.69999999999708962, 908093.60000000149011612 6318373.69999999925494194 511.5, 908091 6318368.80000000074505806 513.30000000000291038, 908088.60000000149011612 6318362.10000000149011612 515, 908081.79999999701976776 6318355.30000000074505806 517.39999999999417923, 908078 6318353.60000000149011612 515.5, 908072.70000000298023224 6318355.89999999850988388 515.30000000000291038, 908066.20000000298023224 6318361 515.5, 908063.10000000149011612 6318363.60000000149011612 514.30000000000291038, 908061 6318365.60000000149011612 514.30000000000291038, 908056.5 6318380.69999999925494194 513.80000000000291038, 908050.10000000149011612 6318390.39999999850988388 512.69999999999708962, 908040.79999999701976776 6318394.60000000149011612 512.5, 908028.89999999850988388 6318394.60000000149011612 511.30000000000291038, 908013.20000000298023224 6318393.69999999925494194 509.10000000000582077, 908008.79999999701976776 6318393.19999999925494194 511.10000000000582077, 907997.5 6318392.10000000149011612 509, 907987.70000000298023224 6318394.69999999925494194 507.69999999999708962)',
# 'LineString(908175.10000000149011612 6318490 485.60000000000582077, 908163.89999999850988388 6318496.5 483.80000000000291038, 908154.70000000298023224 6318499.19999999925494194 484.5, 908144.60000000149011612 6318496.30000000074505806 485.10000000000582077, 908134.10000000149011612 6318490.60000000149011612 486.5, 908130.60000000149011612 6318484.10000000149011612 486.30000000000291038, 908130.29999999701976776 6318476.30000000074505806 486.69999999999708962, 908131 6318467.89999999850988388 487.89999999999417923, 908128.79999999701976776 6318457.30000000074505806 487.80000000000291038, 908127.39999999850988388 6318447.89999999850988388 489.30000000000291038, 908126.5 6318437.60000000149011612 490.60000000000582077, 908128 6318434.69999999925494194 491.80000000000291038)']

# cas sioux : talus collee en partie Ã  la route
# roads = ['LineString(909874.10000000149011612 6317885.60000000149011612 698.39999999999417923, 909874.5 6317888.69999999925494194 697.30000000000291038, 909871.89999999850988388 6317895.5 697.10000000000582077, 909861.10000000149011612 6317909.10000000149011612 692.10000000000582077, 909852.20000000298023224 6317916.60000000149011612 694.10000000000582077, 909845.79999999701976776 6317919.89999999850988388 693.30000000000291038, 909826.39999999850988388 6317930.30000000074505806 690.60000000000582077, 909814.20000000298023224 6317937.89999999850988388 688.69999999999708962, 909808.70000000298023224 6317939.89999999850988388 687.89999999999417923, 909803.29999999701976776 6317940 687, 909797.20000000298023224 6317938.80000000074505806 686.39999999999417923, 909792.20000000298023224 6317938.39999999850988388 685.60000000000582077, 909788.20000000298023224 6317939.5 685.10000000000582077, 909786.60000000149011612 6317941.5 684.19999999999708962, 909785.5 6317944.69999999925494194 683.10000000000582077, 909785.20000000298023224 6317948.60000000149011612 682.69999999999708962, 909785.89999999850988388 6317953.19999999925494194 682.30000000000291038, 909788 6317956.10000000149011612 682.19999999999708962, 909792.5 6317958.89999999850988388 681.69999999999708962, 909800.79999999701976776 6317961.89999999850988388 681.10000000000582077, 909809 6317961.89999999850988388 680.69999999999708962, 909815.20000000298023224 6317960.69999999925494194 680.30000000000291038, 909822.60000000149011612 6317959.10000000149011612 680.5, 909827.10000000149011612 6317959.69999999925494194 678.80000000000291038, 909831.10000000149011612 6317961.10000000149011612 678.89999999999417923, 909832.60000000149011612 6317963.60000000149011612 678.89999999999417923, 909832.70000000298023224 6317965.69999999925494194 678.19999999999708962, 909831.10000000149011612 6317968.60000000149011612 678.10000000000582077, 909822.29999999701976776 6317973.89999999850988388 676.60000000000582077, 909812.39999999850988388 6317980.39999999850988388 675.89999999999417923, 909805 6317983.89999999850988388 675.60000000000582077, 909797.89999999850988388 6317986 674.10000000000582077, 909790.29999999701976776 6317986.30000000074505806 672.80000000000291038, 909781 6317985.69999999925494194 671.30000000000291038, 909773.60000000149011612 6317985.89999999850988388 670.30000000000291038, 909769.60000000149011612 6317986.89999999850988388 669.19999999999708962, 909764.29999999701976776 6317989.80000000074505806 668.60000000000582077, 909755.89999999850988388 6317997.10000000149011612 666.5, 909744.39999999850988388 6318011.30000000074505806 664.80000000000291038, 909736.89999999850988388 6318019.19999999925494194 664.19999999999708962, 909732.70000000298023224 6318024.10000000149011612 663.5, 909730 6318029 663.5, 909729.70000000298023224 6318034.30000000074505806 664, 909731 6318040.89999999850988388 663.10000000000582077, 909734 6318050.10000000149011612 661.10000000000582077, 909739.79999999701976776 6318059.60000000149011612 660.89999999999417923, 909745 6318065.30000000074505806 660.19999999999708962, 909749 6318071.39999999850988388 659.39999999999417923, 909750.79999999701976776 6318077.10000000149011612 659.10000000000582077, 909751.5 6318084.89999999850988388 658.19999999999708962, 909750.89999999850988388 6318094.80000000074505806 657, 909749.60000000149011612 6318101 656.30000000000291038, 909747.5 6318105.69999999925494194 655.39999999999417923, 909745.60000000149011612 6318109.5 655.30000000000291038, 909745.20000000298023224 6318112 654.80000000000291038, 909745.79999999701976776 6318115.19999999925494194 654.19999999999708962, 909747.5 6318118 653.19999999999708962, 909750.79999999701976776 6318119.60000000149011612 653.39999999999417923, 909754.60000000149011612 6318120.10000000149011612 653.19999999999708962, 909759.10000000149011612 6318120.30000000074505806 652.30000000000291038, 909764.79999999701976776 6318119.10000000149011612 651.80000000000291038, 909769.60000000149011612 6318116.39999999850988388 651.39999999999417923, 909777.20000000298023224 6318111.10000000149011612 650.30000000000291038, 909781 6318106.69999999925494194 648.69999999999708962, 909784.5 6318100.10000000149011612 648.19999999999708962, 909788 6318092 647.19999999999708962, 909790 6318088.89999999850988388 646.5, 909792.70000000298023224 6318087.89999999850988388 646.19999999999708962, 909796 6318088.19999999925494194 646, 909798.39999999850988388 6318089.39999999850988388 645.39999999999417923, 909801.79999999701976776 6318092.39999999850988388 645, 909803.5 6318097 644.10000000000582077, 909803.79999999701976776 6318101.39999999850988388 643.80000000000291038, 909803 6318107.10000000149011612 643.39999999999417923, 909802.60000000149011612 6318111 643, 909802.5 6318114.39999999850988388 643.30000000000291038, 909802.79999999701976776 6318116.5 643.19999999999708962, 909803.39999999850988388 6318117.39999999850988388 642.89999999999417923, 909804.39999999850988388 6318118.19999999925494194 642.89999999999417923, 909805.5 6318118.30000000074505806 642.89999999999417923, 909807.20000000298023224 6318117.39999999850988388 642.89999999999417923, 909808.10000000149011612 6318115.89999999850988388 642.39999999999417923, 909809.20000000298023224 6318113 642, 909812.39999999850988388 6318106.80000000074505806 641.19999999999708962, 909814.5 6318102.39999999850988388 640.5, 909818.29999999701976776 6318097.60000000149011612 641.19999999999708962)',
# 'LineString(909874.10000000149011612 6317885.60000000149011612 698.39999999999417923, 909872.79999999701976776 6317884.5 698, 909870.39999999850988388 6317884.10000000149011612 697.89999999999417923, 909866.60000000149011612 6317884.30000000074505806 698.19999999999708962, 909860.89999999850988388 6317885.5 698.60000000000582077, 909855.29999999701976776 6317887.39999999850988388 699, 909850.20000000298023224 6317887.80000000074505806 699.19999999999708962, 909844.70000000298023224 6317887.5 699.80000000000291038, 909839.70000000298023224 6317885.89999999850988388 700.60000000000582077, 909833.89999999850988388 6317883.19999999925494194 701, 909827.60000000149011612 6317877.69999999925494194 701.30000000000291038, 909823.89999999850988388 6317872.60000000149011612 701.60000000000582077, 909821.20000000298023224 6317865.5 702, 909819.60000000149011612 6317856.60000000149011612 702, 909819.60000000149011612 6317847.19999999925494194 702, 909820.60000000149011612 6317838.89999999850988388 702.39999999999417923, 909825.5 6317826.60000000149011612 703.10000000000582077, 909827.20000000298023224 6317821.39999999850988388 703)']
# talus = ['LineString(909822.60000000149011612 6317959.10000000149011612 680.5, 909815.20000000298023224 6317960.69999999925494194 680.30000000000291038, 909809 6317961.89999999850988388 680.69999999999708962, 909800.79999999701976776 6317961.89999999850988388 681.10000000000582077, 909792.5 6317958.89999999850988388 681.69999999999708962, 909788 6317956.10000000149011612 682.19999999999708962, 909785.89999999850988388 6317953.19999999925494194 682.30000000000291038, 909785.20000000298023224 6317948.60000000149011612 682.69999999999708962, 909785.5 6317944.69999999925494194 683.10000000000582077, 909786.60000000149011612 6317941.5 681.89999999999417923, 909782.39999999850988388 6317934.30000000074505806 684.5, 909779.60000000149011612 6317928.60000000149011612 683.80000000000291038, 909777.70000000298023224 6317922.39999999850988388 683.80000000000291038, 909777 6317916.80000000074505806 683.80000000000291038, 909776 6317911.69999999925494194 684, 909775.20000000298023224 6317906.10000000149011612 683.89999999999417923, 909773.60000000149011612 6317901.19999999925494194 683.30000000000291038, 909771.29999999701976776 6317895.19999999925494194 683.10000000000582077, 909769.39999999850988388 6317890.39999999850988388 682.80000000000291038, 909768.20000000298023224 6317883.60000000149011612 682.89999999999417923, 909766.60000000149011612 6317878.80000000074505806 683.39999999999417923, 909763.70000000298023224 6317873.19999999925494194 682.69999999999708962, 909763.10000000149011612 6317867.80000000074505806 682.30000000000291038, 909762.5 6317861.5 680.80000000000291038, 909758.79999999701976776 6317856.5 677.89999999999417923, 909754 6317852 677.10000000000582077, 909748.89999999850988388 6317848.30000000074505806 676, 909745.60000000149011612 6317845.39999999850988388 674.30000000000291038, 909742.89999999850988388 6317841.5 671.89999999999417923, 909739 6317839.30000000074505806 670.30000000000291038, 909734.10000000149011612 6317836.89999999850988388 669.19999999999708962, 909729.89999999850988388 6317835.69999999925494194 665.39999999999417923)']

# # cas sioux : talus colle en 1 point
# roads = ['LineString(908902.29999999701976776 6317655.19999999925494194 595.30000000000291038, 908904 6317648.10000000149011612 598.10000000000582077, 908904.79999999701976776 6317641 598.5, 908904.29999999701976776 6317626.69999999925494194 599.60000000000582077, 908900.79999999701976776 6317585.80000000074505806 601.19999999999708962, 908899.60000000149011612 6317566.39999999850988388 600.69999999999708962, 908899.20000000298023224 6317562.60000000149011612 602.19999999999708962, 908894.89999999850988388 6317536.39999999850988388 603.69999999999708962, 908891.5 6317504.80000000074505806 606.5, 908889.5 6317487.89999999850988388 608.39999999999417923, 908889.89999999850988388 6317475.69999999925494194 609.5, 908891.10000000149011612 6317465.30000000074505806 610.10000000000582077, 908892.89999999850988388 6317454.80000000074505806 610.5, 908893.89999999850988388 6317448.39999999850988388 611.19999999999708962, 908896.89999999850988388 6317429.60000000149011612 613.60000000000582077, 908900 6317407.5 616.5, 908900.10000000149011612 6317398.60000000149011612 617.30000000000291038, 908899.29999999701976776 6317393.89999999850988388 618.19999999999708962, 908897.10000000149011612 6317385.80000000074505806 619.19999999999708962, 908895.70000000298023224 6317381.5 618.69999999999708962, 908892.70000000298023224 6317372.60000000149011612 620.60000000000582077, 908886.60000000149011612 6317355.69999999925494194 622.5, 908885.29999999701976776 6317352.60000000149011612 622.69999999999708962, 908879.70000000298023224 6317337.5 624, 908876.60000000149011612 6317328 625.39999999999417923, 908875.89999999850988388 6317322 620.80000000000291038)']
# talus = ['LineString(908895.70000000298023224 6317381.5 618.69999999999708962, 908883 6317372.39999999850988388 619.39999999999417923, 908869.5 6317361.89999999850988388 618.80000000000291038, 908859.39999999850988388 6317352.39999999850988388 617.80000000000291038, 908853.29999999701976776 6317345.60000000149011612 616.69999999999708962, 908846.39999999850988388 6317338.69999999925494194 616.30000000000291038, 908837.39999999850988388 6317332.69999999925494194 616.30000000000291038, 908825.5 6317325.69999999925494194 615.39999999999417923, 908804 6317314.39999999850988388 611)']

# roads = ['LineString(910630.20000000298023224 6314911.89999999850988388 541.80000000000291038, 910627.39999999850988388 6314916.5 541.80000000000291038, 910624.5 6314921.10000000149011612 542.39999999999417923, 910624.20000000298023224 6314935.39999999850988388 545.30000000000291038, 910622.20000000298023224 6314956.19999999925494194 548.19999999999708962, 910622.29999999701976776 6314977.10000000149011612 551.19999999999708962, 910625.79999999701976776 6314997.89999999850988388 554.60000000000582077, 910626.20000000298023224 6315009.60000000149011612 556.5, 910625.89999999850988388 6315021.89999999850988388 557.69999999999708962, 910624 6315045.39999999850988388 560.10000000000582077, 910621.70000000298023224 6315057.80000000074505806 561, 910615.70000000298023224 6315081.39999999850988388 563.60000000000582077, 910611.89999999850988388 6315090.19999999925494194 565.5, 910605.39999999850988388 6315098.39999999850988388 566.80000000000291038, 910590.79999999701976776 6315110.30000000074505806 570.19999999999708962, 910578.60000000149011612 6315122.60000000149011612 572, 910575.5 6315129.19999999925494194 573.19999999999708962, 910573.29999999701976776 6315140.39999999850988388 574, 910572.20000000298023224 6315176.80000000074505806 575.69999999999708962, 910572.5 6315186.30000000074505806 577, 910573.70000000298023224 6315197.60000000149011612 577.69999999999708962, 910576.60000000149011612 6315208.10000000149011612 579.30000000000291038, 910579.70000000298023224 6315217.60000000149011612 580.30000000000291038, 910588 6315236 581.69999999999708962, 910590.79999999701976776 6315245.30000000074505806 582.30000000000291038, 910591.89999999850988388 6315264.80000000074505806 584.60000000000582077, 910591.79999999701976776 6315275.69999999925494194 586.30000000000291038, 910591.10000000149011612 6315286.19999999925494194 586.89999999999417923, 910589.60000000149011612 6315295.69999999925494194 588.30000000000291038, 910586.89999999850988388 6315306.89999999850988388 589, 910580.79999999701976776 6315325.80000000074505806 591.10000000000582077, 910575.60000000149011612 6315336.19999999925494194 592.5, 910566.60000000149011612 6315354.89999999850988388 594.19999999999708962, 910563.39999999850988388 6315365 595.30000000000291038, 910562.10000000149011612 6315372.10000000149011612 596.30000000000291038, 910558.39999999850988388 6315376.80000000074505806 595.89999999999417923, 910553.29999999701976776 6315381.19999999925494194 595.19999999999708962, 910547.20000000298023224 6315387.69999999925494194 594.80000000000291038, 910536.60000000149011612 6315403.10000000149011612 593.30000000000291038, 910523.79999999701976776 6315417.69999999925494194 593.19999999999708962, 910518 6315426 594, 910511.60000000149011612 6315435.60000000149011612 594.39999999999417923, 910502.20000000298023224 6315454.30000000074505806 596, 910496.39999999850988388 6315463.69999999925494194 597.10000000000582077, 910492.39999999850988388 6315472.89999999850988388 597.89999999999417923, 910486.10000000149011612 6315480.39999999850988388 599, 910476 6315488 600.10000000000582077, 910471.60000000149011612 6315489.19999999925494194 600.80000000000291038, 910463.70000000298023224 6315486.89999999850988388 601, 910456.29999999701976776 6315485.69999999925494194 601.80000000000291038, 910445.79999999701976776 6315486.30000000074505806 602.10000000000582077, 910424.10000000149011612 6315490.5 602.69999999999708962, 910410.89999999850988388 6315494.5 603, 910383.89999999850988388 6315499.39999999850988388 603.5, 910371.79999999701976776 6315501.60000000149011612 604, 910363.70000000298023224 6315504.39999999850988388 604.19999999999708962, 910359 6315506 605.19999999999708962, 910352.60000000149011612 6315508 605.19999999999708962, 910345 6315513.60000000149011612 605.89999999999417923, 910338.60000000149011612 6315522.10000000149011612 606.19999999999708962, 910330.60000000149011612 6315529.39999999850988388 606.80000000000291038, 910319.10000000149011612 6315543.89999999850988388 607.60000000000582077, 910316 6315548.30000000074505806 608.39999999999417923, 910310.5 6315553.5 609.5, 910303.89999999850988388 6315558.30000000074505806 611.60000000000582077, 910297.29999999701976776 6315567.10000000149011612 612.30000000000291038, 910285.89999999850988388 6315585.80000000074505806 614.80000000000291038, 910283.20000000298023224 6315591.39999999850988388 615.89999999999417923, 910276.79999999701976776 6315604.30000000074505806 616.39999999999417923, 910273.5 6315614.60000000149011612 617.10000000000582077, 910272.89999999850988388 6315619.30000000074505806 617.39999999999417923, 910269.29999999701976776 6315628.10000000149011612 618.19999999999708962, 910262.20000000298023224 6315637.39999999850988388 619.19999999999708962, 910255.79999999701976776 6315643.60000000149011612 619.60000000000582077, 910249.70000000298023224 6315648.89999999850988388 620.10000000000582077, 910241.20000000298023224 6315655.60000000149011612 620.80000000000291038, 910237.39999999850988388 6315659.60000000149011612 620.80000000000291038, 910270.70000000298023224 6315657.39999999850988388 625, 910297.10000000149011612 6315654.5 627.80000000000291038, 910308.89999999850988388 6315652.39999999850988388 628.80000000000291038, 910319.89999999850988388 6315648.89999999850988388 629.5, 910329.89999999850988388 6315644.5 630.60000000000582077, 910363.39999999850988388 6315629.39999999850988388 632, 910382.5 6315619.60000000149011612 632, 910398.5 6315612.89999999850988388 633, 910405.29999999701976776 6315611.30000000074505806 633.60000000000582077, 910411.79999999701976776 6315611.60000000149011612 634.19999999999708962, 910416.29999999701976776 6315614 634.80000000000291038, 910419.29999999701976776 6315617.19999999925494194 635, 910421.39999999850988388 6315621.19999999925494194 635.69999999999708962, 910422.10000000149011612 6315625.60000000149011612 636.30000000000291038, 910421.60000000149011612 6315631 636.69999999999708962, 910417.60000000149011612 6315649 639.39999999999417923, 910409.79999999701976776 6315692.39999999850988388 644.89999999999417923, 910421.10000000149011612 6315704.19999999925494194 646.5, 910448.29999999701976776 6315737.60000000149011612 648.89999999999417923, 910453 6315739 649.10000000000582077, 910457.70000000298023224 6315740.69999999925494194 649.30000000000291038, 910485.29999999701976776 6315751.89999999850988388 652.30000000000291038, 910511.89999999850988388 6315761.80000000074505806 654.19999999999708962, 910523.29999999701976776 6315766.80000000074505806 655.80000000000291038, 910553 6315777.80000000074505806 655.39999999999417923, 910587.39999999850988388 6315790.60000000149011612 661, 910607 6315797.80000000074505806 662.30000000000291038, 910617.60000000149011612 6315801 663.80000000000291038, 910623.10000000149011612 6315802.60000000149011612 664.30000000000291038, 910640.70000000298023224 6315809 666, 910666.10000000149011612 6315820.5 666.60000000000582077, 910701.79999999701976776 6315834.5 666.69999999999708962)']
# # # river
# #roads.append('LineString(910457.70000000298023224 6315740.69999999925494194 649.30000000000291038, 910455.10000000149011612 6315728.89999999850988388 644.89999999999417923, 910457.20000000298023224 6315716.89999999850988388 641.10000000000582077, 910460.5 6315705.10000000149011612 637.80000000000291038, 910465.89999999850988388 6315694.30000000074505806 635.30000000000291038, 910469.60000000149011612 6315678.80000000074505806 633.80000000000291038, 910468.79999999701976776 6315662.19999999925494194 632.10000000000582077, 910467.29999999701976776 6315649.30000000074505806 629.80000000000291038, 910470.20000000298023224 6315638.10000000149011612 627.5, 910475.20000000298023224 6315627.30000000074505806 625.60000000000582077, 910481.5 6315617.5 624.80000000000291038, 910485.70000000298023224 6315607.80000000074505806 623.19999999999708962, 910483.60000000149011612 6315587.80000000074505806 620, 910486.39999999850988388 6315579.60000000149011612 617.60000000000582077, 910487.29999999701976776 6315571.80000000074505806 615.30000000000291038, 910485.60000000149011612 6315562.30000000074505806 612.5, 910482.29999999701976776 6315554.10000000149011612 610.30000000000291038, 910484.5 6315544.5 608.10000000000582077, 910489.89999999850988388 6315536.5 606.39999999999417923, 910491.89999999850988388 6315528.60000000149011612 605, 910489.5 6315521.19999999925494194 603.80000000000291038, 910489.20000000298023224 6315520.10000000149011612 603.69999999999708962, 910483.89999999850988388 6315511.60000000149011612 602.89999999999417923, 910479.20000000298023224 6315498.19999999925494194 601.10000000000582077, 910476 6315488 600.10000000000582077, 910474 6315470.60000000149011612 593, 910475.20000000298023224 6315451.5 589.39999999999417923, 910479.10000000149011612 6315425.5 584.69999999999708962, 910483.70000000298023224 6315414.39999999850988388 582.5, 910491.29999999701976776 6315402.69999999925494194 580.5, 910492.20000000298023224 6315390.5 579.30000000000291038, 910491.60000000149011612 6315379.10000000149011612 577.39999999999417923, 910495.29999999701976776 6315368.80000000074505806 577.80000000000291038, 910498.70000000298023224 6315355.30000000074505806 573.5, 910497.29999999701976776 6315344.80000000074505806 571.60000000000582077, 910494.5 6315336.30000000074505806 568.80000000000291038, 910489.60000000149011612 6315329 566.19999999999708962, 910484.10000000149011612 6315322.30000000074505806 563.19999999999708962, 910469.70000000298023224 6315291.80000000074505806 556.80000000000291038, 910455 6315274.30000000074505806 554.19999999999708962, 910449.20000000298023224 6315263.5 553.80000000000291038, 910438.89999999850988388 6315260 552.19999999999708962, 910428.89999999850988388 6315254.39999999850988388 550.80000000000291038, 910422.20000000298023224 6315242.19999999925494194 549.60000000000582077, 910416.5 6315234.80000000074505806 548.30000000000291038, 910414.89999999850988388 6315232.69999999925494194 548, 910406.10000000149011612 6315225.30000000074505806 546.60000000000582077, 910399.20000000298023224 6315217.5 544.39999999999417923, 910392.10000000149011612 6315210.69999999925494194 542.89999999999417923, 910381.79999999701976776 6315198 539.89999999999417923, 910373.39999999850988388 6315191.39999999850988388 538.39999999999417923)')
# talus =['LineString(910256.70000000298023224 6315649.30000000074505806 622.39999999999417923, 910262.39999999850988388 6315642.80000000074505806 622.30000000000291038, 910275.60000000149011612 6315629.5 622.19999999999708962, 910281.39999999850988388 6315620.80000000074505806 622.19999999999708962, 910287 6315611.39999999850988388 622.10000000000582077, 910300.39999999850988388 6315586.60000000149011612 621.69999999999708962, 910308 6315590.39999999850988388 621.80000000000291038)',
# 'LineString(910310.20000000298023224 6315573.89999999850988388 617.89999999999417923, 910313.60000000149011612 6315568 618.10000000000582077, 910326 6315558.5 617.60000000000582077, 910343.60000000149011612 6315551 616.30000000000291038, 910374.20000000298023224 6315535.60000000149011612 613.80000000000291038, 910388.5 6315527.19999999925494194 612.80000000000291038, 910402.60000000149011612 6315517.60000000149011612 611.30000000000291038, 910414.89999999850988388 6315508 610.5, 910427 6315500.89999999850988388 609.39999999999417923, 910437.39999999850988388 6315497.19999999925494194 608.89999999999417923, 910449.20000000298023224 6315502 609.10000000000582077, 910459.89999999850988388 6315509.69999999925494194 609.5, 910475.20000000298023224 6315526.39999999850988388 613.30000000000291038, 910472.60000000149011612 6315535.10000000149011612 616.80000000000291038, 910468.60000000149011612 6315543.10000000149011612 619.60000000000582077, 910466.79999999701976776 6315550.60000000149011612 621.60000000000582077, 910465.5 6315561.5 625.30000000000291038, 910468.20000000298023224 6315570.5 626.89999999999417923, 910476 6315581.19999999925494194 628, 910475 6315592.19999999925494194 629.10000000000582077, 910472.89999999850988388 6315599.89999999850988388 630.5, 910473.70000000298023224 6315610.10000000149011612 632.10000000000582077, 910462.79999999701976776 6315628.89999999850988388 634.60000000000582077, 910462.89999999850988388 6315641.80000000074505806 636.10000000000582077, 910456.79999999701976776 6315652.5 637.80000000000291038, 910456.60000000149011612 6315655.60000000149011612 638, 910456.29999999701976776 6315663.89999999850988388 638.69999999999708962, 910459.39999999850988388 6315676.5 640, 910458.20000000298023224 6315686.89999999850988388 641.19999999999708962, 910452 6315702.89999999850988388 642.5, 910449.20000000298023224 6315708.10000000149011612 642.5)',
# 'LineString(910346.79999999701976776 6315571.39999999850988388 621.69999999999708962, 910350.70000000298023224 6315565.19999999925494194 622.30000000000291038, 910357.79999999701976776 6315560.5 622.30000000000291038, 910370 6315555 622.30000000000291038, 910382.89999999850988388 6315550.30000000074505806 622.30000000000291038, 910396.20000000298023224 6315546 622.30000000000291038, 910408.5 6315542.39999999850988388 622.30000000000291038, 910421.60000000149011612 6315540.30000000074505806 622.30000000000291038, 910431.39999999850988388 6315539.30000000074505806 622.30000000000291038, 910437.5 6315538.69999999925494194 622.30000000000291038, 910442.70000000298023224 6315538.5 622.60000000000582077, 910446.5 6315540.19999999925494194 622.80000000000291038, 910447.5 6315546.19999999925494194 623, 910448.39999999850988388 6315551.19999999925494194 623, 910451.20000000298023224 6315555.69999999925494194 623.10000000000582077, 910456.89999999850988388 6315558.30000000074505806 623.10000000000582077, 910465.5 6315561.5 625.30000000000291038)',
# 'LineString(910378 6315569.30000000074505806 626.19999999999708962, 910382.10000000149011612 6315579.5 627.10000000000582077, 910383.79999999701976776 6315588.5 629.30000000000291038, 910385.89999999850988388 6315595.10000000149011612 630.10000000000582077, 910387.10000000149011612 6315600.10000000149011612 630, 910389.39999999850988388 6315600.5 629.89999999999417923, 910394.70000000298023224 6315595 629.39999999999417923, 910398.70000000298023224 6315589.19999999925494194 629.39999999999417923, 910405.5 6315583.5 629.19999999999708962, 910414.10000000149011612 6315579.89999999850988388 628.80000000000291038, 910421.60000000149011612 6315577.5 628.80000000000291038, 910428.60000000149011612 6315575.39999999850988388 628.80000000000291038, 910436.10000000149011612 6315574.89999999850988388 628.69999999999708962, 910443.60000000149011612 6315574.10000000149011612 628.5, 910450.79999999701976776 6315576.19999999925494194 628.5, 910456.39999999850988388 6315578.69999999925494194 628.5, 910460.70000000298023224 6315580 628.5)'
# 'LineString(910479.60000000149011612 6315702.19999999925494194 642.19999999999708962, 910479.60000000149011612 6315701.5 642.10000000000582077, 910476.89999999850988388 6315657.60000000149011612 635.60000000000582077, 910483.10000000149011612 6315642.30000000074505806 633.5, 910484.29999999701976776 6315640.5 633.19999999999708962, 910491.79999999701976776 6315628.80000000074505806 631.60000000000582077, 910493.79999999701976776 6315613.80000000074505806 630.30000000000291038, 910494.89999999850988388 6315597.89999999850988388 627.5, 910499.39999999850988388 6315584.10000000149011612 625.19999999999708962, 910505 6315570.5 622.69999999999708962, 910507.39999999850988388 6315562.39999999850988388 621.39999999999417923, 910509.39999999850988388 6315555.80000000074505806 620.39999999999417923, 910510.79999999701976776 6315544.30000000074505806 618.19999999999708962, 910511 6315533.19999999925494194 615.60000000000582077, 910509.89999999850988388 6315523.60000000149011612 613.80000000000291038, 910506.10000000149011612 6315515.30000000074505806 611.69999999999708962, 910502.10000000149011612 6315509.39999999850988388 611.69999999999708962)',
# 'LineString(910479.20000000298023224 6315498.19999999925494194 601.10000000000582077, 910496.60000000149011612 6315479 605, 910507.39999999850988388 6315464.89999999850988388 604.39999999999417923, 910517.89999999850988388 6315445.39999999850988388 603, 910524.10000000149011612 6315435 602.80000000000291038, 910530.60000000149011612 6315425.80000000074505806 602.10000000000582077, 910547.10000000149011612 6315408.39999999850988388 601.30000000000291038, 910559 6315385.39999999850988388 600.5, 910564 6315381.60000000149011612 600.80000000000291038, 910570.39999999850988388 6315378.89999999850988388 602.10000000000582077, 910579.89999999850988388 6315378.89999999850988388 602.89999999999417923, 910610.60000000149011612 6315385.80000000074505806 602, 910617.20000000298023224 6315387.19999999925494194 604, 910626.5 6315390.19999999925494194 604.10000000000582077, 910656.20000000298023224 6315393.10000000149011612 605.30000000000291038, 910678.20000000298023224 6315397.60000000149011612 604.39999999999417923, 910689 6315398.89999999850988388 604, 910703.70000000298023224 6315399.80000000074505806 603.10000000000582077, 910752.89999999850988388 6315396.30000000074505806 599.39999999999417923)']

# roads = ['LINESTRING (908759.299999997 6325224.600000001, 908737.1000000015 6325232.600000001, 908727.1000000015 6325237.899999999, 908720.3999999985 6325241.800000001, 908715.6000000015 6325244.800000001, 908710.700000003 6325246.300000001, 908706.700000003 6325246.800000001, 908702.799999997 6325245.300000001, 908699.1000000015 6325242.5, 908697.6000000015 6325239.800000001, 908697.1000000015 6325235.5, 908699.5 6325229.899999999, 908707.1000000015 6325217.800000001, 908709.5 6325210.800000001, 908712 6325202.699999999, 908712.6000000015 6325191.300000001, 908714.1000000015 6325184.800000001, 908716 6325179.699999999, 908705.1000000015 6325169.600000001, 908678.5 6325143.100000001, 908639.799999997 6325105.399999999, 908604.700000003 6325069.899999999, 908575.1000000015 6325042.600000001, 908565 6325032.199999999, 908557.299999997 6325022.300000001, 908550.200000003 6325010.399999999, 908544.299999997 6324997.800000001, 908529.6000000015 6324956.399999999, 908515.1000000015 6324918.399999999, 908503.3999999985 6324888, 908496.1000000015 6324885.399999999, 908487.6000000015 6324882.100000001, 908484.6000000015 6324882.100000001, 908482.799999997 6324883.399999999, 908482.6000000015 6324886.100000001, 908484.6000000015 6324892.600000001, 908490.3999999985 6324910, 908495.5 6324931, 908498.6000000015 6324939.199999999, 908500.8999999985 6324945.600000001, 908504 6324955, 908506 6324972.899999999, 908508.8999999985 6324985.399999999, 908514.8999999985 6325014.899999999, 908518.8999999985 6325027.5, 908527.8999999985 6325048.600000001, 908530.700000003 6325056, 908589.700000003 6325121.899999999, 908614.5 6325156, 908630.6000000015 6325185.199999999, 908643.299999997 6325213.5, 908650.5 6325235.100000001, 908656.200000003 6325254.899999999, 908664.700000003 6325317.800000001, 908663.299999997 6325331, 908668.200000003 6325331.800000001, 908672.200000003 6325331.899999999, 908675.3999999985 6325327.800000001, 908677.799999997 6325318.399999999, 908687.299999997 6325300.5, 908698.200000003 6325290.399999999, 908717.6000000015 6325285.800000001, 908734 6325286.399999999, 908743 6325292.100000001, 908751 6325314.300000001, 908778.5 6325440.199999999, 908793.5 6325507.100000001, 908800.299999997 6325518.800000001, 908855.8999999985 6325604.5, 908898.700000003 6325676.399999999, 908922 6325725, 908957.299999997 6325802.899999999, 908965.6000000015 6325806.899999999, 908969.700000003 6325803.699999999, 908957.8999999985 6325780.100000001, 908954.200000003 6325772.699999999, 908947.299999997 6325758.699999999, 908936.8999999985 6325733.399999999, 908926.299999997 6325704.600000001, 908924.8999999985 6325700.800000001, 908914.8999999985 6325670.800000001, 908904 6325640.399999999, 908899.799999997 6325628.699999999, 908890.6000000015 6325604.5, 908878.1000000015 6325579.699999999, 908872.1000000015 6325567.899999999, 908870.5 6325564.600000001, 908860.8999999985 6325549.699999999, 908853.700000003 6325537.600000001, 908845.299999997 6325521.899999999, 908838.5 6325505.699999999, 908833.8999999985 6325491.399999999, 908833 6325488.300000001, 908824.3999999985 6325459.899999999, 908816 6325436.199999999, 908806.1000000015 6325410.399999999, 908801.799999997 6325397.399999999, 908798.8999999985 6325383.300000001, 908796.1000000015 6325366.899999999, 908794.799999997 6325347.899999999, 908792.6000000015 6325326, 908791.8999999985 6325320.199999999, 908790.6000000015 6325309.600000001, 908788.700000003 6325295.600000001, 908786.700000003 6325287.199999999, 908785.299999997 6325281.399999999, 908780.299999997 6325265, 908773.5 6325248.699999999, 908764.8999999985 6325232.699999999, 908759.299999997 6325224.600000001)']
# talus = ['LINESTRING (908557.4516880757 6325022.55882567 636.9571428571425, 908565.1502284225 6325032.459675606 636.9571428571425, 908575.2469003479 6325042.861572722 636.9571428571425, 908604.8330755112 6325070.168869686 636.9571428571425, 908639.9106389588 6325105.678853042 636.9571428571425, 908678.5667430048 6325143.392481405 650)',
# 'LINESTRING (908726.9990153582 6325238.182492657 656.5, 908736.962573435 6325232.86667197 656.5, 908759.1097823516 6325224.831985448 654.5, 908764.6818942952 6325232.905985198 654.5, 908773.2383245963 6325248.846717357 658.9833333333323, 908780.0105143955 6325265.078727927 658.9833333333323, 908785.0001740832 6325281.410218677 658.9833333333323, 908786.400274415 6325287.187171442 658.9833333333323)']

roads= ['LineString (921772.29999999701976776 6300515.19999999925494194 314.89999999999417923, 921754.29999999701976776 6300458.30000000074505806 313.39999999999417923, 921748.89999999850988388 6300443.69999999925494194 313, 921731.5 6300400.19999999925494194 313.5, 921730.79999999701976776 6300398.30000000074505806 313.30000000000291038, 921724.20000000298023224 6300385.39999999850988388 313.69999999999708962, 921716.5 6300372.5 313.80000000000291038, 921698.89999999850988388 6300347.10000000149011612 314.30000000000291038, 921682.60000000149011612 6300320.30000000074505806 315.60000000000582077, 921674.39999999850988388 6300308.80000000074505806 315.80000000000291038, 921653.89999999850988388 6300275.30000000074505806 317.19999999999708962, 921637.79999999701976776 6300251.10000000149011612 316, 921631.20000000298023224 6300239.39999999850988388 314.5, 921629.70000000298023224 6300237.30000000074505806 315.30000000000291038, 921622.20000000298023224 6300226.80000000074505806 314.39999999999417923, 921608.39999999850988388 6300205.30000000074505806 313.69999999999708962, 921602.70000000298023224 6300195.10000000149011612 312.5, 921591.89999999850988388 6300172.39999999850988388 311.89999999999417923)',
        'LineString (921591.89999999850988388 6300172.39999999850988388 311.89999999999417923, 921580.89999999850988388 6300153.10000000149011612 310.80000000000291038, 921561.5 6300114.19999999925494194 308.39999999999417923, 921553.20000000298023224 6300099.19999999925494194 307.80000000000291038, 921549.10000000149011612 6300091.80000000074505806 307, 921543.89999999850988388 6300078.30000000074505806 306.80000000000291038, 921537.89999999850988388 6300063.60000000149011612 306.19999999999708962, 921534.89999999850988388 6300057.39999999850988388 306.89999999999417923)',
        'LineString (921895.60000000149011612 6300461.19999999925494194 301.60000000000582077, 921853.5 6300486.60000000149011612 304.5, 921842.70000000298023224 6300494.10000000149011612 305.80000000000291038, 921834.70000000298023224 6300501.30000000074505806 307.80000000000291038, 921808.89999999850988388 6300512 310.19999999999708962, 921786 6300520.60000000149011612 312.30000000000291038, 921777.20000000298023224 6300517.69999999925494194 313.5, 921772.29999999701976776 6300515.19999999925494194 314.89999999999417923)']


talus = ['LineString (921773.25039712607394904 6300514.88896093890070915, 921749.85039712756406516 6300443.38896093890070915, 921749.82889940356835723 6300443.32966785784810781, 921731.72889940207824111 6300397.92966785933822393, 921731.69024816015735269 6300397.84452419728040695, 921725.09024816611781716 6300384.94452419504523277, 921725.04113295197021216 6300384.85917159449309111, 921613.73617682245094329 6300211.75016815867275, 921609.26997530751395971 6300204.80402918811887503, 921592.79388313530944288 6300171.9516999451443553)']


DECIMATE_EDGES = False
BUF = 15 #+1.5 #6.5

roads_shapes = [loads(r) for r in roads]
talus_shapes = [loads(t) for t in talus]
talus_lengths = [len(t.coords) for t in talus_shapes]

points_talus = get_points_talus(talus_shapes)
edges = get_edges_from_triangulation(points_talus, talus_lengths, decimate=DECIMATE_EDGES)
#edges = [ (e[0], e[1]) for e in edges ]

#LSDisplacer.set_params(MAX_ITER=250, PAngles=50, PEdges_ext=0, PEdges_int=10, Pedges_ext_far=0, DIST='MIN')
LSDisplacer.set_params(MAX_ITER=250, DIST='MIN', ANGLES_CONST=True, NORM_DX=0.3,
                       PAngles=50, PEdges_ext=50, Pedges_ext_far=1, PEdges_int=5, PEdges_int_non_seg=2, PDistRoads=1000)
#loglsd.setLevel(logging.WARNING)

displacer = LSDisplacer(points_talus, roads, talus_lengths, edges, buffer=BUF)
displacer2 = LSDisplacer(points_talus, roads, talus_lengths, edges, buffer=BUF)
P = displacer.get_P()
print("P matrix size", P.shape)
res = displacer.square()
displacer.print_linestrings_wkts()

# lines = displacer.get_linestrings_wkts()
# print(type(lines), len(lines), lines.shape, res.shape)
# print(edges, type(edges), edges.shape)